<h1>Список задач</h1>

<table border="1">
  <col width="90">
  <thead>
    <tr>
      <th>Дата/Время</th><th>Метод</th><th>Входные данные</th><th>Код ошибки/проверки</th><th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @ws_jobs.each do |ws_job| %>
      <tr>
        <td><small><%= ws_job.updated_at %></small></td>
        <td><%= ws_job.ws_method.name %></td>
        <td><%= ws_job.input[0..150] + (ws_job.input.size > 150 ? " ..." : "") %></td>
        <td><%= ws_job.error_code %>/<%= ws_job.for_check %>/<%= ws_job.do_check %></td>
        <% if ws_job.do_check==0 or current_user.admin? %>
          <td><%= link_to 'Редактировать', edit_ws_job_path(ws_job) %></td>
          <td><%= link_to 'Удалить', ws_job, method: :delete, data: { confirm: 'Вы уверены?' } %></td>
        <% end %>
        <% unless ws_job.output.nil? %>
          <td><%= link_to 'Показать результат', ws_job %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<br>
<% if current_user.ws_jobs.size < current_user.numjobs or current_user.admin? %>
  <%= link_to 'Новая задача', new_ws_job_path %>
<% end %>
